<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, inital-scale=1.0">
        <title>Nimbus Console Buffer Experiment</title>
        <link rel="stylesheet" href="../../css/experiment_style.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/7.0.0/normalize.min.css">
        <link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed&family=Roboto+Slab:wght@300;600&display=swap" rel="stylesheet">

        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,1,0" />
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,1,0" />


    </head>
    <body>
        <header>
            <nav class="nav-bar">
                <div class="nav-link-directories">
                <a class="nav-link-directory nav-link" href="https://www.anilkarabulut.com">www.anilkarabulut.com</a>
                <span class="nav-link-directory-seperator"> / </span>
                <a class="nav-link-directory nav-link" href="/experiments.html">experiments</a>
                </div>
                <div class="intro--socials">
                <a href="https://github.com/MisterNimbus" target="_blank">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 30 24" style="enable-background:new 0 0 30 24;" xml:space="preserve" class="icon">
                        <g>
                            <path fill="#fff" class="st0" d="M15,4c-4.5,0-8.2,3.7-8.2,8.2c0,3.6,2.4,6.7,5.6,7.8c0.4,0.1,0.6-0.2,0.6-0.4c0-0.2,0-0.8,0-1.5
                                c-2.3,0.5-2.8-1-2.8-1c-0.4-0.9-0.9-1.2-0.9-1.2c-0.7-0.5,0.1-0.5,0.1-0.5c0.8,0.1,1.3,0.8,1.3,0.8c0.7,1.3,1.9,0.9,2.4,0.7
                                c0.1-0.5,0.3-0.9,0.5-1.1c-1.8-0.2-3.7-0.9-3.7-4.1c0-0.9,0.3-1.6,0.8-2.2c-0.1-0.2-0.4-1,0.1-2.2c0,0,0.7-0.2,2.3,0.8
                                C13.6,8.1,14.3,8,15,8c0.7,0,1.4,0.1,2.1,0.3c1.6-1.1,2.3-0.8,2.3-0.8c0.4,1.1,0.2,2,0.1,2.2c0.5,0.6,0.8,1.3,0.8,2.2
                                c0,3.2-1.9,3.8-3.7,4c0.3,0.3,0.6,0.8,0.6,1.5c0,1.1,0,2,0,2.3c0,0.2,0.1,0.5,0.6,0.4c3.3-1.1,5.6-4.2,5.6-7.8
                                C23.2,7.7,19.5,4,15,4z"></path>
                            <path fill="#fff" class="st1" d="M9.9,15.8c0,0-0.1,0.1-0.1,0c-0.1,0-0.1-0.1-0.1-0.1c0,0,0.1-0.1,0.1,0C9.9,15.7,9.9,15.7,9.9,15.8L9.9,15.8z
                                M9.8,15.7"></path>
                            <path fill="#fff" class="st1" d="M10.2,16.1c0,0-0.1,0-0.2,0C10,16.1,10,16,10,15.9c0,0,0.1,0,0.2,0C10.3,16,10.3,16.1,10.2,16.1L10.2,16.1z
                                M10.2,16.1"></path>
                            <path fill="#fff" class="st1" d="M10.6,16.6c-0.1,0-0.1,0-0.2-0.1c-0.1-0.1-0.1-0.2,0-0.2c0.1,0,0.1,0,0.2,0.1C10.6,16.5,10.6,16.6,10.6,16.6
                                L10.6,16.6z M10.6,16.6"></path>
                            <path fill="#fff" class="st1" d="M11,17.1c0,0-0.1,0-0.2,0c-0.1-0.1-0.1-0.2,0-0.2c0,0,0.1,0,0.2,0C11,16.9,11.1,17,11,17.1L11,17.1z M11,17.1"></path>
                            <path fill="#fff" class="st1" d="M11.6,17.3c0,0.1-0.1,0.1-0.2,0.1c-0.1,0-0.2-0.1-0.1-0.2c0-0.1,0.1-0.1,0.2-0.1
                                C11.6,17.2,11.6,17.3,11.6,17.3L11.6,17.3z M11.6,17.3"></path>
                            <path fill="#fff" class="st1" d="M12.3,17.4c0,0.1-0.1,0.1-0.2,0.1c-0.1,0-0.2-0.1-0.2-0.1c0-0.1,0.1-0.1,0.2-0.1
                                C12.2,17.3,12.3,17.3,12.3,17.4L12.3,17.4z M12.3,17.4"></path>
                            <path fill="#fff" class="st1" d="M12.9,17.3c0,0.1-0.1,0.1-0.2,0.2c-0.1,0-0.2,0-0.2-0.1c0-0.1,0.1-0.1,0.2-0.2C12.8,17.2,12.9,17.2,12.9,17.3
                                L12.9,17.3z M12.9,17.3"></path>
                        </g>
                    </svg>
                </a>
                <a href="mailto:bartu.anil.karabulut@rwth-aachen.de">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 30 24" style="enable-background:new 0 0 30 24;" xml:space="preserve" class="icon">
                        <g>
                            <path fill="#fff" d="M15,13L7.1,7.1c0-0.5,0.4-1,1-1h13.8c0.5,0,1,0.4,1,1L15,13z M15,14.8l7.9-5.9v8.1c0,0.5-0.4,1-1,1H8.1c-0.5,0-1-0.4-1-1 V8.8L15,14.8z"></path>
                        </g>
                    </svg>
                </a>
                <a href="https://www.linkedin.com/in/bartu-anil-karabulut/" target="_blank">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 30 24" style="enable-background:new 0 0 30 24;" xml:space="preserve" class="icon">
                        <path fill="#fff" id="path-1_24_" d="M19.6,19v-5.8c0-1.4-0.5-2.4-1.7-2.4c-1,0-1.5,0.7-1.8,1.3C16,12.3,16,12.6,16,13v6h-3.4
                            c0,0,0.1-9.8,0-10.8H16v1.5c0,0,0,0,0,0h0v0C16.4,9,17.2,7.9,19,7.9c2.3,0,4,1.5,4,4.9V19H19.6z M8.9,6.7L8.9,6.7
                            C7.7,6.7,7,5.9,7,4.9C7,3.8,7.8,3,8.9,3s1.9,0.8,1.9,1.9C10.9,5.9,10.1,6.7,8.9,6.7z M10.6,19H7.2V8.2h3.4V19z"></path>
                    </svg>
                </a>
            </div>
            </nav>
        </header>
        <main>
            <!-- My Services -->
            <section class="experiment-section">
                <div class="experiment-head">
                    <div>
                        <h1 class="experiment-title">
                            Console Buffer Experiment
                        </h1>
                        <hr>
                        <div class="date-github-over-hr">
                            <a class="experiment-title-github" target="_blank" href="https://github.com/MisterNimbus/Experiments/tree/master/ConsoleBufferExperiment">
                                <span>
                                <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 30 24" style="enable-background:new 0 0 30 24;" xml:space="preserve" class="title-github-icon">
                        <g>
                            <path fill="#fff" class="st0" d="M15,4c-4.5,0-8.2,3.7-8.2,8.2c0,3.6,2.4,6.7,5.6,7.8c0.4,0.1,0.6-0.2,0.6-0.4c0-0.2,0-0.8,0-1.5
                                c-2.3,0.5-2.8-1-2.8-1c-0.4-0.9-0.9-1.2-0.9-1.2c-0.7-0.5,0.1-0.5,0.1-0.5c0.8,0.1,1.3,0.8,1.3,0.8c0.7,1.3,1.9,0.9,2.4,0.7
                                c0.1-0.5,0.3-0.9,0.5-1.1c-1.8-0.2-3.7-0.9-3.7-4.1c0-0.9,0.3-1.6,0.8-2.2c-0.1-0.2-0.4-1,0.1-2.2c0,0,0.7-0.2,2.3,0.8
                                C13.6,8.1,14.3,8,15,8c0.7,0,1.4,0.1,2.1,0.3c1.6-1.1,2.3-0.8,2.3-0.8c0.4,1.1,0.2,2,0.1,2.2c0.5,0.6,0.8,1.3,0.8,2.2
                                c0,3.2-1.9,3.8-3.7,4c0.3,0.3,0.6,0.8,0.6,1.5c0,1.1,0,2,0,2.3c0,0.2,0.1,0.5,0.6,0.4c3.3-1.1,5.6-4.2,5.6-7.8
                                C23.2,7.7,19.5,4,15,4z"></path>
                            <path fill="#fff" class="st1" d="M9.9,15.8c0,0-0.1,0.1-0.1,0c-0.1,0-0.1-0.1-0.1-0.1c0,0,0.1-0.1,0.1,0C9.9,15.7,9.9,15.7,9.9,15.8L9.9,15.8z
                                M9.8,15.7"></path>
                            <path fill="#fff" class="st1" d="M10.2,16.1c0,0-0.1,0-0.2,0C10,16.1,10,16,10,15.9c0,0,0.1,0,0.2,0C10.3,16,10.3,16.1,10.2,16.1L10.2,16.1z
                                M10.2,16.1"></path>
                            <path fill="#fff" class="st1" d="M10.6,16.6c-0.1,0-0.1,0-0.2-0.1c-0.1-0.1-0.1-0.2,0-0.2c0.1,0,0.1,0,0.2,0.1C10.6,16.5,10.6,16.6,10.6,16.6
                                L10.6,16.6z M10.6,16.6"></path>
                            <path fill="#fff" class="st1" d="M11,17.1c0,0-0.1,0-0.2,0c-0.1-0.1-0.1-0.2,0-0.2c0,0,0.1,0,0.2,0C11,16.9,11.1,17,11,17.1L11,17.1z M11,17.1"></path>
                            <path fill="#fff" class="st1" d="M11.6,17.3c0,0.1-0.1,0.1-0.2,0.1c-0.1,0-0.2-0.1-0.1-0.2c0-0.1,0.1-0.1,0.2-0.1
                                C11.6,17.2,11.6,17.3,11.6,17.3L11.6,17.3z M11.6,17.3"></path>
                            <path fill="#fff" class="st1" d="M12.3,17.4c0,0.1-0.1,0.1-0.2,0.1c-0.1,0-0.2-0.1-0.2-0.1c0-0.1,0.1-0.1,0.2-0.1
                                C12.2,17.3,12.3,17.3,12.3,17.4L12.3,17.4z M12.3,17.4"></path>
                            <path fill="#fff" class="st1" d="M12.9,17.3c0,0.1-0.1,0.1-0.2,0.2c-0.1,0-0.2,0-0.2-0.1c0-0.1,0.1-0.1,0.2-0.2C12.8,17.2,12.9,17.2,12.9,17.3
                                L12.9,17.3z M12.9,17.3"></path>
                        </g>
                                </svg>
                                </span>
                            Github Repository
                            </a>
                            <span class="experiment-date">02.07.2022</span>
                        </div>
                        
                        <hr>
                    </div>
                    
                    <h3 class="experiment-text">
                        During the previous Bitmap_to_ASCII Experiment it had came to my attention that the frames could not be printed 
                        fast enough to the windows console. I wanted to find a way to solve this problem. I found out about Console Buffers 
                        from the windows.h library, which to a degree solved my problems.
                        <br><br>
                        At first I had to understand how it all worked since the resources on this topic were a lot more scarce than I was 
                        used to. I worked with what I had and experimented with what I could find. 
                    </h3>
                    <h2 class="experiment-subtitle"> Results: </h2>   
                    <div>
                        <h3 class="experiment-text">
                        Buffers allow frames to be prepared while still in the background calling WriteConsoleOutputCharacter(...) and 
                        FillConsoleOutputAttribute(...)  to be revealed when SetConsoleActiveScreenBuffer(...) gets called. With this method 
                        the flickering frames problem was resolved, which was due to chars not being output fast enough to form the frame, 
                        resulting in sort of a horizontal scanning effect.
                        <br><br>
                        Since it was now possible to incorperate colors into my buffers. I started by giving writing ' ' throughout the buffer 
                        and changing the color of another section using a nested for loop scanning the coordinates. The resulting screen made me 
                        realize although the frame rate was higher than reguler cout, they were not instantenous and I could once again see the 
                        background flickering! With every frame the background got painted and then the inner section got horizontally scanned 
                        and got painted. As the inner section could not get painted fast enough, it was possible to see the inner sections colours 
                        geting changed in a horizontal scan motion, once again causing "flickering". I got through this problem by having two buffers 
                        and toggling between them. The Buffer to be the next frame gets prepared and activated once it is ready instead of getting 
                        activated and prepared while visible. That ceased the flickering. (See strobe_(epilepsy-warning).gif)
                        </h3>
                        <div style="display: flex; flex-direction: column; align-items: center; margin-top: 2em; margin-bottom: 2em;">
                            <button style="display:inline; color: #fff; background-color: #000; padding:.5em" onclick='toggle_visibility("strobe"); '>SHOW STROBE (EPILEPSY WARNING)</button>
                            <script>
                                function toggle_visibility(id){
                                    const element = document.getElementById( id );
                                    if(element.style.visibility == "hidden"){
                                    element.style.visibility = "visible";
                                    }else{
                                        element.style.visibility = "hidden";
                                    }
                                }
                            </script>
                            <style>
                                #warning{
                                    width:600px; 
                                    height: 100%;  
                                    display: flex; 
                                    justify-content:center; 
                                    margin-top: 1em;
                                }
                                @media(max-width: 600px)
                                {
                                    #warning{
                                    width: 100%; 
                                    background-size: cover;
                                    }
                                }
                            </style>
                            <div id="warning" style="background-image: url(/Experiments/ConsoleBufferExperiment/EPILEPSY_WARNING.png);">
                                <img id="strobe" style="visibility:hidden;" src="/Experiments/ConsoleBufferExperiment/strobe_(epilepsy-warning).gif" alt="Strobe">
                            </div>
                        </div>
                        <h3 class="experiment-text">
                        Now that the flickering was gone I decided I wanted to try making something colourful with all I have learned. So I wrote the 
                        rainbow function that output a diagonal rainbow pattern that moved on char left on each frame. Since every block was of another 
                        colour, each block had to be changed for each frame which meant it would take plenty of time for the next frame buffer to be 
                        ready which dropped the frame rate significantly.
                        </h3>
                        <div style="display: flex; flex-direction: column; align-items: center; margin-top: 2em; margin-bottom: 2em;">
                            <img src="/Experiments/ConsoleBufferExperiment/rainbow.gif" alt="rainbow gif">
                        </div>
                        <h3 class="experiment-text">
                        To solve this problem I thought of preparing all frames(Buffers) first and just cycling through them, which worked nicely 
                        allowing higher frame rates. (See rainbow_premade_frames.gif) However this method can only be resorted when the frames 
                        are known beforehand. It would not be possible to use this method for a game or a live webcam. It would however be possible to 
                        use screen buffers just to output strings fast, since it is the number of times console buffer manipulation functions get 
                        called that takes time and not the length of the string or area to be manipulated. The rainbow case is the worst example for 
                        this instance since the color manipulation function gets called the maximum amount of times (once for every char).
                        </h3>
                        <div style="display: flex; flex-direction: column; align-items: center; margin-top: 2em; margin-bottom: 2em;">
                            <img src="/Experiments/ConsoleBufferExperiment/rainbow_premade_frames.gif" alt="rainbow premade frames gif">
                        </div>
                        <h3 class="experiment-text">
                            As next, I am planning to write a program to turn images or even gifs into ASCII Art with color.
                            <br><br>
                            Cheers!
                        </h3>
                        
                    </div>
                </div>
            </section>
        <!-- Footer -->
        <footer>
            <a>Bartu AnÄ±l Karabulut - 2022</a>
        </footer>
    </body>
</html>